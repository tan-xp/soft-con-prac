<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.softcon.mapper.ExamSubmissionMapper">
    <select id="getByExamAndStudent" resultType="com.softcon.entity.ExamSubmission">
        SELECT id, exam_id AS examId, student_id AS studentId, student_name AS studentName,
               submission_time AS submissionTime, score, status, answers
        FROM exam_submission
        WHERE exam_id = #{examId} AND student_id = #{studentId}
        LIMIT 1
    </select>

    <select id="getByExamId" resultType="com.softcon.entity.ExamSubmission">
        SELECT id, exam_id AS examId, student_id AS studentId, student_name AS studentName,
               submission_time AS submissionTime, score, status, answers
        FROM exam_submission
        WHERE exam_id = #{examId}
        ORDER BY id
    </select>

    <select id="getByStudentId" resultType="com.softcon.entity.ExamSubmission">
        SELECT id, exam_id AS examId, student_id AS studentId, student_name AS studentName,
               submission_time AS submissionTime, score, status, answers
        FROM exam_submission
        WHERE student_id = #{studentId}
        ORDER BY id
    </select>

    <insert id="insert" parameterType="com.softcon.entity.ExamSubmission" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO exam_submission (exam_id, student_id, student_name, submission_time, score, status, answers)
        VALUES (#{examId}, #{studentId}, #{studentName}, #{submissionTime}, #{score}, #{status}, #{answers})
    </insert>

    <update id="update" parameterType="com.softcon.entity.ExamSubmission">
        UPDATE exam_submission
        SET submission_time = #{submissionTime},
            score = #{score},
            status = #{status},
            answers = #{answers}
        WHERE id = #{id}
    </update>
</mapper>